# nginx.service\n[Unit]\nDescription=Nginx SSL Service\nRequires=gaia.service\nPartOf=gaia.service\nAfter=gaia.service\nAfter=gaia-hub.service\nAfter=gaia-reader.service\nAfter=gaia-admin.service\nConditionPathExists=/tmp/letsencrypt.init\n\n[Service]\nWorkingDirectory=/gaia\nEnvironmentFile=/gaia/gaia.env\nEnvironmentFile=/etc/environment\nTimeoutStartSec=0\n#Restart=always\nRestart=on-failure\nRemainAfterExit=yes\nRestartSec=5\nExecStartPre=sh /gaia/scripts/update-configs.sh\nExecStartPre=-/usr/bin/docker stop nginx\nExecStartPre=-/usr/bin/docker pull ${NGINX_IMAGE}\nExecStart=/usr/bin/docker run \\\n  --rm \\\n  --net=gaia \\\n  -m 128m \\\n  -p 80:80 \\\n  -p 443:443 \\\n  --expose=80 \\\n  --expose=443 \\\n  --oom-kill-disable \\\n  -v /gaia/nginx/conf.d/default.conf:/etc/nginx/conf.d/default.conf \\\n  -v /gaia/nginx/conf.d/nginx.conf:/etc/nginx/nginx.conf \\\n  -v /gaia/nginx/html/index.html:/usr/share/nginx/html/index.html \\\n  -v ${LOCAL_CERTBOT_CONF}:${REMOTE_CERTBOT_CONF} \\\n  -v ${LOCAL_CERTBOT_WWW}:${REMOTE_CERTBOT_WWW} \\\n  --name nginx \\\n  ${NGINX_IMAGE}\n\nExecStop=-/usr/bin/docker stop nginx\nExecReload=-/usr/bin/docker restart nginx\n\n[Install]\nWantedBy=gaia.service\n
